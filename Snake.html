<!DOCTYPE html>
<html>

<head>
  <script src="js/pixi.min.js"></script>
  <script src="js/graphics-extras.js"></script>
  <style></style>
</head>

<body>
  <script>
    // Set up the application stage
    const app = new PIXI.Application({ width: 621, height: 496, background: "#1099bb" })
    // Set up the game border
    const border = new PIXI.Graphics()
    border.lineStyle(5, "#000000", 1)
    border.beginFill("#1099bb")
    border.drawRect(0, 0, 505, 380)
    border.endFill()

    // Set up the container for the game
    const gameContainer = new PIXI.Container()
    gameContainer.position = { x: 50, y: 50 }
    gameContainer.width = 505
    gameContainer.height = 380

    // Set up components dimension
    const snakeSize = 25;
    const foodSize = 12.5
    const snakeBody = [];

    // Store snake body coordinate as an object
    // Snake body will be record as block number
    // X have 0-19 block and Y have 0-14 block
    function storeCoordinate(xVal, yVal, array) {
      array.push({ x: xVal, y: yVal });
    }

    // Initialise the snake 
    // head (column 11 row 4 ) body (column 11 row3 and column 11 row 2)
    storeCoordinate(10, 3, snakeBody)
    storeCoordinate(10, 2, snakeBody)
    storeCoordinate(10, 1, snakeBody)

    const snake = new PIXI.Graphics()

    function drawSnake() {
      snake.clear();
      for (let i = 0; i < snakeBody.length; i++) {
        if (i == 0) {
          snake.beginFill("#8b0000")
          snake.drawRoundedRect(2 + snakeBody[i].x * snakeSize, 3 + snakeBody[i].y * snakeSize, snakeSize, snakeSize, 8);
          snake.endFill()

        } else {
          snake.beginFill("#2a2b2a")
          snake.drawRoundedRect(2 + snakeBody[i].x * snakeSize, 3 + snakeBody[i].y * snakeSize, snakeSize, snakeSize, 8);
          snake.endFill()
        }
      }
    }
    drawSnake();

    function updateSnake(direction) {
      let prevX = snakeBody[0].x
      let prevY = snakeBody[0].y
      if (direction == "bottom") {
        for (let i = 1; i < snakeBody.length; i++) {
          let tempX = snakeBody[i].x
          let tempY = snakeBody[i].y
          snakeBody[i].x = prevX
          snakeBody[i].y = prevY
          prevX = tempX
          prevY = tempY
        }
        snakeBody[0].y += 1
        console.log(snakeBody)
      }
    }


    // Initialise the food (coordination have to added itself)
    // const food = new PIXI.Graphics()
    // food.lineStyle(0)
    // food.beginFill("#2a2b2a", 1);
    // food.drawStar(22.5, 22.5, 4, 12.5);
    // food.endFill();

    // Render everything into the stage
    document.body.appendChild(app.view)
    gameContainer.addChild(border)
    app.stage.addChild(gameContainer)
    gameContainer.addChild(snake)



    // Start game
    let elapsed = 0.0;
    app.ticker.add((delta) => {
      elapsed += delta
      if (Math.round(elapsed) == 50 || Math.round(elapsed) == 100) {
        updateSnake("bottom")
      }
      drawSnake()
    })

  </script>
</body>

</html>